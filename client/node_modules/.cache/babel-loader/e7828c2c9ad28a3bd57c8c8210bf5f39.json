{"ast":null,"code":"import _classCallCheck from\"C:/Users/mikhaylovv/PycharmProjects/second_eye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/mikhaylovv/PycharmProjects/second_eye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/mikhaylovv/PycharmProjects/second_eye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/mikhaylovv/PycharmProjects/second_eye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _taggedTemplateLiteral from\"C:/Users/mikhaylovv/PycharmProjects/second_eye/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{Component}from\"react\";import{ScatterChart,CartesianGrid,Legend,XAxis,YAxis,ReferenceLine,ZAxis,Scatter}from\"recharts\";import{gql}from'@apollo/client';import{graphql}from'@apollo/client/react/hoc';import moment from'moment';import Typography from'@material-ui/core/Typography';import{Box,Link}from\"@material-ui/core\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var fetchSystemChangeRequest=gql(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    query SystemChangeRequestByIdQuery($id: String!) {\\n        systemChangeRequestById(id: $id) {\\n            id \\n            url\\n            name\\n            state {\\n                name\\n            }\\n            \\n            analysisEstimate\\n            analysisTimeSpent\\n            analysisTimeLeft\\n            analysisTimeSheetsByDate {\\n                date\\n                timeSpentCumsum\\n            }\\n            \\n            developmentEstimate\\n            developmentTimeSpent\\n            developmentTimeLeft\\n            developmentTimeSheetsByDate {\\n                date\\n                timeSpentCumsum\\n            }\\n            \\n            testingEstimate\\n            testingTimeSpent\\n            testingTimeLeft\\n            testingTimeSheetsByDate {\\n                date\\n                timeSpentCumsum\\n            }\\n            \\n            estimate\\n            timeSpent\\n            timeLeft\\n            timeSheetsByDate {\\n                date\\n                timeSpentCumsum\\n            }\\n            \\n            changeRequest {\\n                plannedInstallDate\\n            }\\n        }\\n    }\\n\"])));var SystemChangeRequestDetail=/*#__PURE__*/function(_Component){_inherits(SystemChangeRequestDetail,_Component);var _super=_createSuper(SystemChangeRequestDetail);function SystemChangeRequestDetail(){_classCallCheck(this,SystemChangeRequestDetail);return _super.apply(this,arguments);}_createClass(SystemChangeRequestDetail,[{key:\"render\",value:function render(){if(this.props.data.loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading ...\"});}var plannedInstallDate=this.props.data.systemChangeRequestById.changeRequest.plannedInstallDate?new Date(this.props.data.systemChangeRequestById.changeRequest.plannedInstallDate).getTime():null;var timeSheetsByDate=this.props.data.systemChangeRequestById.timeSheetsByDate;var today=new Date().getTime();var firstTimeSheetDate=timeSheetsByDate.length>0?new Date(timeSheetsByDate[0].date).getTime():null;var lastTimeSheetDate=timeSheetsByDate.length>0?new Date(timeSheetsByDate[timeSheetsByDate.length-1].date).getTime():null;var allEdgeDates=[today];if(plannedInstallDate){allEdgeDates.push(plannedInstallDate);}if(firstTimeSheetDate){allEdgeDates.push(firstTimeSheetDate);}if(lastTimeSheetDate){allEdgeDates.push(lastTimeSheetDate);}var xAxisStart=Math.min.apply(Math,allEdgeDates);var xAxisEnd=Math.max.apply(Math,allEdgeDates);return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body1\",noWrap:true,children:[/*#__PURE__*/_jsx(Link,{href:this.props.location.pathname,children:this.props.data.systemChangeRequestById.id}),\" \\xA0\",this.props.data.systemChangeRequestById.name,\" \\xA0\",this.props.data.systemChangeRequestById.state.name,\" \\xA0\",/*#__PURE__*/_jsx(Link,{href:this.props.data.systemChangeRequestById.url,children:\"[ \\u0438\\u0441\\u0442\\u043E\\u0447\\u043D\\u0438\\u043A ]\"}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u041E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C \",this.props.data.systemChangeRequestById.timeLeft,\" \\u0447 ( \",(this.props.data.systemChangeRequestById.timeLeft/this.props.data.systemChangeRequestById.estimate*100).toFixed(2),\"% ) \",/*#__PURE__*/_jsx(\"br\",{}),\"\\u0421\\u0434\\u0435\\u043B\\u0430\\u043D\\u043E \",this.props.data.systemChangeRequestById.timeSpent,\" \\u0447 \",/*#__PURE__*/_jsx(\"br\",{}),\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430 \",this.props.data.systemChangeRequestById.estimate,\" \\u0447 \",/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(ScatterChart,{width:1440,height:200,margin:{left:-5},children:[/*#__PURE__*/_jsx(CartesianGrid,{}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\",type:\"number\",domain:[xAxisStart-1000*60*60*24*28,xAxisEnd+1000*60*60*24*28],allowDataOverflow:true,tickFormatter:function tickFormatter(date){return moment(date).format('YYYY-MM-DD');}}),/*#__PURE__*/_jsx(YAxis,{type:\"number\",dataKey:\"timeSpentCumsum\"}),/*#__PURE__*/_jsx(ZAxis,{type:\"number\",range:[1]}),/*#__PURE__*/_jsx(Legend,{}),plannedInstallDate?/*#__PURE__*/_jsx(ReferenceLine,{x:new Date(plannedInstallDate).getTime(),stroke:\"red\",strokeDasharray:\"5 5\",label:\"\\u041F\\u043B\\u0430\\u043D\\u043E\\u0432\\u0430\\u044F \\u0434\\u0430\\u0442\\u0430 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043A\\u0438\",ifOverflow:\"extendDomain\"}):\"\",/*#__PURE__*/_jsx(ReferenceLine,{x:today,stroke:\"blue\",strokeDasharray:\"5 5\",label:\"\\u0421\\u0435\\u0433\\u043E\\u0434\\u043D\\u044F\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(ReferenceLine,{y:this.props.data.systemChangeRequestById.estimate,stroke:\"black\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(Scatter,{name:\"\\u0421\\u043F\\u0438\\u0441\\u0430\\u043D\\u043E \\u0432\\u0441\\u0435\\u0433\\u043E\",data:this.props.data.systemChangeRequestById.timeSheetsByDate.map(function(item){return{date:new Date(item.date).getTime(),timeSpentCumsum:item.timeSpentCumsum};}),line:true,fill:\"black\"})]}),/*#__PURE__*/_jsxs(ScatterChart,{width:1440,height:200,margin:{left:-5},children:[/*#__PURE__*/_jsx(CartesianGrid,{}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\",type:\"number\",domain:[xAxisStart-1000*60*60*24*28,xAxisEnd+1000*60*60*24*28],allowDataOverflow:true,tickFormatter:function tickFormatter(date){return moment(date).format('YYYY-MM-DD');}}),/*#__PURE__*/_jsx(YAxis,{type:\"number\",dataKey:\"timeSpentCumsum\"}),/*#__PURE__*/_jsx(ZAxis,{type:\"number\",range:[1]}),/*#__PURE__*/_jsx(Legend,{}),plannedInstallDate?/*#__PURE__*/_jsx(ReferenceLine,{x:new Date(plannedInstallDate).getTime(),stroke:\"red\",strokeDasharray:\"5 5\",label:\"\\u041F\\u043B\\u0430\\u043D\\u043E\\u0432\\u0430\\u044F \\u0434\\u0430\\u0442\\u0430 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043A\\u0438\",ifOverflow:\"extendDomain\"}):\"\",/*#__PURE__*/_jsx(ReferenceLine,{x:today,stroke:\"blue\",strokeDasharray:\"5 5\",label:\"\\u0421\\u0435\\u0433\\u043E\\u0434\\u043D\\u044F\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(ReferenceLine,{y:this.props.data.systemChangeRequestById.analysisEstimate,stroke:\"red\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(Scatter,{name:\"\\u0421\\u043F\\u0438\\u0441\\u0430\\u043D\\u043E \\u0430\\u043D\\u0430\\u043B\\u0438\\u0442\\u0438\\u043A\\u0430\",data:this.props.data.systemChangeRequestById.analysisTimeSheetsByDate.map(function(item){return{date:new Date(item.date).getTime(),timeSpentCumsum:item.timeSpentCumsum};}),line:true,fill:\"red\"})]}),/*#__PURE__*/_jsxs(ScatterChart,{width:1440,height:200,margin:{left:-5},children:[/*#__PURE__*/_jsx(CartesianGrid,{}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\",type:\"number\",domain:[xAxisStart-1000*60*60*24*28,xAxisEnd+1000*60*60*24*28],allowDataOverflow:true,tickFormatter:function tickFormatter(date){return moment(date).format('YYYY-MM-DD');}}),/*#__PURE__*/_jsx(YAxis,{type:\"number\",dataKey:\"timeSpentCumsum\"}),/*#__PURE__*/_jsx(ZAxis,{type:\"number\",range:[1]}),/*#__PURE__*/_jsx(Legend,{}),plannedInstallDate?/*#__PURE__*/_jsx(ReferenceLine,{x:new Date(plannedInstallDate).getTime(),stroke:\"red\",strokeDasharray:\"5 5\",label:\"\\u041F\\u043B\\u0430\\u043D\\u043E\\u0432\\u0430\\u044F \\u0434\\u0430\\u0442\\u0430 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043A\\u0438\",ifOverflow:\"extendDomain\"}):\"\",/*#__PURE__*/_jsx(ReferenceLine,{x:today,stroke:\"blue\",strokeDasharray:\"5 5\",label:\"\\u0421\\u0435\\u0433\\u043E\\u0434\\u043D\\u044F\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(ReferenceLine,{y:this.props.data.systemChangeRequestById.developmentEstimate,stroke:\"green\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(Scatter,{name:\"\\u0421\\u043F\\u0438\\u0441\\u0430\\u043D\\u043E \\u0440\\u0430\\u0437\\u0440\\u0430\\u0431\\u043E\\u0442\\u043A\\u0430\",data:this.props.data.systemChangeRequestById.developmentTimeSheetsByDate.map(function(item){return{date:new Date(item.date).getTime(),timeSpentCumsum:item.timeSpentCumsum};}),line:true,fill:\"green\"})]}),/*#__PURE__*/_jsxs(ScatterChart,{width:1440,height:200,margin:{left:-5},children:[/*#__PURE__*/_jsx(CartesianGrid,{}),/*#__PURE__*/_jsx(XAxis,{dataKey:\"date\",type:\"number\",domain:[xAxisStart-1000*60*60*24*28,xAxisEnd+1000*60*60*24*28],allowDataOverflow:true,tickFormatter:function tickFormatter(date){return moment(date).format('YYYY-MM-DD');}}),/*#__PURE__*/_jsx(YAxis,{type:\"number\",dataKey:\"timeSpentCumsum\"}),/*#__PURE__*/_jsx(ZAxis,{type:\"number\",range:[1]}),/*#__PURE__*/_jsx(Legend,{}),plannedInstallDate?/*#__PURE__*/_jsx(ReferenceLine,{x:new Date(plannedInstallDate).getTime(),stroke:\"red\",strokeDasharray:\"5 5\",label:\"\\u041F\\u043B\\u0430\\u043D\\u043E\\u0432\\u0430\\u044F \\u0434\\u0430\\u0442\\u0430 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043A\\u0438\",ifOverflow:\"extendDomain\"}):\"\",/*#__PURE__*/_jsx(ReferenceLine,{x:today,stroke:\"blue\",strokeDasharray:\"5 5\",label:\"\\u0421\\u0435\\u0433\\u043E\\u0434\\u043D\\u044F\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(ReferenceLine,{y:this.props.data.systemChangeRequestById.testingEstimate,stroke:\"blue\",ifOverflow:\"extendDomain\"}),/*#__PURE__*/_jsx(Scatter,{name:\"\\u0421\\u043F\\u0438\\u0441\\u0430\\u043D\\u043E \\u0442\\u0435\\u0441\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\",data:this.props.data.systemChangeRequestById.testingTimeSheetsByDate.map(function(item){return{date:new Date(item.date).getTime(),timeSpentCumsum:item.timeSpentCumsum};}),line:true,fill:\"blue\"})]})]});}}]);return SystemChangeRequestDetail;}(Component);export default graphql(fetchSystemChangeRequest,{options:function options(props){return{variables:{id:props.match.params.id}};}})(SystemChangeRequestDetail);","map":{"version":3,"sources":["C:/Users/mikhaylovv/PycharmProjects/second_eye/client/src/components/SystemChangeRequestDetail.js"],"names":["React","Component","ScatterChart","CartesianGrid","Legend","XAxis","YAxis","ReferenceLine","ZAxis","Scatter","gql","graphql","moment","Typography","Box","Link","fetchSystemChangeRequest","SystemChangeRequestDetail","props","data","loading","plannedInstallDate","systemChangeRequestById","changeRequest","Date","getTime","timeSheetsByDate","today","firstTimeSheetDate","length","date","lastTimeSheetDate","allEdgeDates","push","xAxisStart","Math","min","xAxisEnd","max","location","pathname","id","name","state","url","timeLeft","estimate","toFixed","timeSpent","left","format","map","item","timeSpentCumsum","analysisEstimate","analysisTimeSheetsByDate","developmentEstimate","developmentTimeSheetsByDate","testingEstimate","testingTimeSheetsByDate","options","variables","match","params"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\r\nimport {\r\n    ScatterChart,\r\n    CartesianGrid,\r\n    Legend,\r\n    XAxis,\r\n    YAxis,\r\n    ReferenceLine,\r\n    ZAxis, Scatter\r\n} from \"recharts\";\r\nimport {gql} from '@apollo/client';\r\nimport { graphql } from '@apollo/client/react/hoc';\r\nimport moment from 'moment';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {Box, Link} from \"@material-ui/core\";\r\n\r\nconst fetchSystemChangeRequest = gql`\r\n    query SystemChangeRequestByIdQuery($id: String!) {\r\n        systemChangeRequestById(id: $id) {\r\n            id \r\n            url\r\n            name\r\n            state {\r\n                name\r\n            }\r\n            \r\n            analysisEstimate\r\n            analysisTimeSpent\r\n            analysisTimeLeft\r\n            analysisTimeSheetsByDate {\r\n                date\r\n                timeSpentCumsum\r\n            }\r\n            \r\n            developmentEstimate\r\n            developmentTimeSpent\r\n            developmentTimeLeft\r\n            developmentTimeSheetsByDate {\r\n                date\r\n                timeSpentCumsum\r\n            }\r\n            \r\n            testingEstimate\r\n            testingTimeSpent\r\n            testingTimeLeft\r\n            testingTimeSheetsByDate {\r\n                date\r\n                timeSpentCumsum\r\n            }\r\n            \r\n            estimate\r\n            timeSpent\r\n            timeLeft\r\n            timeSheetsByDate {\r\n                date\r\n                timeSpentCumsum\r\n            }\r\n            \r\n            changeRequest {\r\n                plannedInstallDate\r\n            }\r\n        }\r\n    }\r\n`;\r\n\r\nclass SystemChangeRequestDetail extends Component {\r\n    render() {\r\n        if (this.props.data.loading) { return <div>Loading ...</div> }\r\n\r\n        const plannedInstallDate = this.props.data.systemChangeRequestById.changeRequest.plannedInstallDate ? new Date(this.props.data.systemChangeRequestById.changeRequest.plannedInstallDate).getTime() : null\r\n        const timeSheetsByDate = this.props.data.systemChangeRequestById.timeSheetsByDate\r\n\r\n        const today = (new Date()).getTime()\r\n        const firstTimeSheetDate = timeSheetsByDate.length > 0 ? new Date(timeSheetsByDate[0].date).getTime() : null\r\n        const lastTimeSheetDate = timeSheetsByDate.length > 0 ? new Date(timeSheetsByDate[timeSheetsByDate.length - 1].date).getTime() : null\r\n\r\n        const allEdgeDates = [today]\r\n        if (plannedInstallDate) {\r\n            allEdgeDates.push(plannedInstallDate)\r\n        }\r\n\r\n        if (firstTimeSheetDate) {\r\n            allEdgeDates.push(firstTimeSheetDate)\r\n        }\r\n\r\n        if (lastTimeSheetDate) {\r\n            allEdgeDates.push(lastTimeSheetDate)\r\n        }\r\n\r\n        const xAxisStart = Math.min(...allEdgeDates)\r\n        const xAxisEnd = Math.max(...allEdgeDates)\r\n\r\n        return (\r\n            <Box>\r\n                <Typography variant=\"body1\" noWrap>\r\n                    <Link href={ this.props.location.pathname }>\r\n                        { this.props.data.systemChangeRequestById.id }\r\n                    </Link> &nbsp;\r\n                    { this.props.data.systemChangeRequestById.name } &nbsp;\r\n                    { this.props.data.systemChangeRequestById.state.name } &nbsp;\r\n                    <Link href={ this.props.data.systemChangeRequestById.url }>\r\n                        [ источник ]\r\n                    </Link>\r\n                    <br />\r\n                    Осталось { this.props.data.systemChangeRequestById.timeLeft } ч ( { (this.props.data.systemChangeRequestById.timeLeft / this.props.data.systemChangeRequestById.estimate * 100).toFixed(2) }% ) <br />\r\n                    Сделано { this.props.data.systemChangeRequestById.timeSpent } ч <br />\r\n                    Оценка { this.props.data.systemChangeRequestById.estimate } ч <br />\r\n                </Typography>\r\n                <br />\r\n\r\n                <ScatterChart\r\n                    width={1440}\r\n                    height={200}\r\n                    margin={{\r\n                        left: -5,\r\n                    }}\r\n                >\r\n                    <CartesianGrid />\r\n                    <XAxis\r\n                        dataKey=\"date\"\r\n                        type=\"number\"\r\n                        domain={[xAxisStart - 1000 * 60 * 60 * 24 * 28, xAxisEnd + 1000 * 60 * 60 * 24 * 28]}\r\n                        allowDataOverflow={true}\r\n                        tickFormatter={(date) => moment(date).format('YYYY-MM-DD')}\r\n                    />\r\n                    <YAxis type=\"number\" dataKey=\"timeSpentCumsum\" />\r\n                    <ZAxis type=\"number\" range={[1]} />\r\n                    <Legend/>\r\n\r\n                    {\r\n                        (plannedInstallDate) ?\r\n                            <ReferenceLine x={ new Date(plannedInstallDate).getTime() } stroke=\"red\" strokeDasharray=\"5 5\" label=\"Плановая дата установки\" ifOverflow=\"extendDomain\"/> :\r\n                            \"\"\r\n                    }\r\n\r\n                    <ReferenceLine x={ today } stroke=\"blue\" strokeDasharray=\"5 5\" label=\"Сегодня\" ifOverflow=\"extendDomain\"/>\r\n\r\n                    <ReferenceLine y={this.props.data.systemChangeRequestById.estimate} stroke=\"black\" ifOverflow=\"extendDomain\" />\r\n                    <Scatter\r\n                        name=\"Списано всего\"\r\n                        data= {\r\n                            this.props.data.systemChangeRequestById.timeSheetsByDate.map(item => {\r\n                                return { date: new Date(item.date).getTime(), timeSpentCumsum: item.timeSpentCumsum }\r\n                            })\r\n                        }\r\n                        line fill=\"black\"\r\n                    />\r\n                </ScatterChart>\r\n                <ScatterChart\r\n                    width={1440}\r\n                    height={200}\r\n                    margin={{\r\n                        left: -5,\r\n                    }}\r\n                >\r\n                    <CartesianGrid />\r\n                    <XAxis\r\n                        dataKey=\"date\"\r\n                        type=\"number\"\r\n                        domain={[xAxisStart - 1000 * 60 * 60 * 24 * 28, xAxisEnd + 1000 * 60 * 60 * 24 * 28]}\r\n                        allowDataOverflow={true}\r\n                        tickFormatter={(date) => moment(date).format('YYYY-MM-DD')}\r\n                    />\r\n                    <YAxis type=\"number\" dataKey=\"timeSpentCumsum\" />\r\n                    <ZAxis type=\"number\" range={[1]} />\r\n                    <Legend/>\r\n\r\n                    {\r\n                        (plannedInstallDate) ?\r\n                            <ReferenceLine x={ new Date(plannedInstallDate).getTime() } stroke=\"red\" strokeDasharray=\"5 5\" label=\"Плановая дата установки\" ifOverflow=\"extendDomain\"/> :\r\n                            \"\"\r\n                    }\r\n\r\n                    <ReferenceLine x={ today } stroke=\"blue\" strokeDasharray=\"5 5\" label=\"Сегодня\" ifOverflow=\"extendDomain\"/>\r\n\r\n                    <ReferenceLine y={this.props.data.systemChangeRequestById.analysisEstimate} stroke=\"red\" ifOverflow=\"extendDomain\" />\r\n                    <Scatter\r\n                        name=\"Списано аналитика\"\r\n                        data= {\r\n                            this.props.data.systemChangeRequestById.analysisTimeSheetsByDate.map(item => {\r\n                                return { date: new Date(item.date).getTime(), timeSpentCumsum: item.timeSpentCumsum }\r\n                            })\r\n                        }\r\n                        line fill=\"red\"\r\n                    />\r\n                </ScatterChart>\r\n                 <ScatterChart\r\n                    width={1440}\r\n                    height={200}\r\n                    margin={{\r\n                        left: -5,\r\n                    }}\r\n                >\r\n                    <CartesianGrid />\r\n                    <XAxis\r\n                        dataKey=\"date\"\r\n                        type=\"number\"\r\n                        domain={[xAxisStart - 1000 * 60 * 60 * 24 * 28, xAxisEnd + 1000 * 60 * 60 * 24 * 28]}\r\n                        allowDataOverflow={true}\r\n                        tickFormatter={(date) => moment(date).format('YYYY-MM-DD')}\r\n                    />\r\n                    <YAxis type=\"number\" dataKey=\"timeSpentCumsum\" />\r\n                    <ZAxis type=\"number\" range={[1]} />\r\n                    <Legend/>\r\n\r\n                    {\r\n                        (plannedInstallDate) ?\r\n                            <ReferenceLine x={ new Date(plannedInstallDate).getTime() } stroke=\"red\" strokeDasharray=\"5 5\" label=\"Плановая дата установки\" ifOverflow=\"extendDomain\"/> :\r\n                            \"\"\r\n                    }\r\n\r\n                    <ReferenceLine x={ today } stroke=\"blue\" strokeDasharray=\"5 5\" label=\"Сегодня\" ifOverflow=\"extendDomain\"/>\r\n\r\n                    <ReferenceLine y={this.props.data.systemChangeRequestById.developmentEstimate} stroke=\"green\" ifOverflow=\"extendDomain\" />\r\n                    <Scatter\r\n                        name=\"Списано разработка\"\r\n                        data= {\r\n                            this.props.data.systemChangeRequestById.developmentTimeSheetsByDate.map(item => {\r\n                                return { date: new Date(item.date).getTime(), timeSpentCumsum: item.timeSpentCumsum }\r\n                            })\r\n                        }\r\n                        line fill=\"green\"\r\n                    />\r\n                </ScatterChart>\r\n                <ScatterChart\r\n                    width={1440}\r\n                    height={200}\r\n                    margin={{\r\n                        left: -5,\r\n                    }}\r\n                >\r\n                    <CartesianGrid />\r\n                    <XAxis\r\n                        dataKey=\"date\"\r\n                        type=\"number\"\r\n                        domain={[xAxisStart - 1000 * 60 * 60 * 24 * 28, xAxisEnd + 1000 * 60 * 60 * 24 * 28]}\r\n                        allowDataOverflow={true}\r\n                        tickFormatter={(date) => moment(date).format('YYYY-MM-DD')}\r\n                    />\r\n                    <YAxis type=\"number\" dataKey=\"timeSpentCumsum\" />\r\n                    <ZAxis type=\"number\" range={[1]} />\r\n                    <Legend/>\r\n\r\n                    {\r\n                        (plannedInstallDate) ?\r\n                            <ReferenceLine x={ new Date(plannedInstallDate).getTime() } stroke=\"red\" strokeDasharray=\"5 5\" label=\"Плановая дата установки\" ifOverflow=\"extendDomain\"/> :\r\n                            \"\"\r\n                    }\r\n\r\n                    <ReferenceLine x={ today } stroke=\"blue\" strokeDasharray=\"5 5\" label=\"Сегодня\" ifOverflow=\"extendDomain\"/>\r\n\r\n                    <ReferenceLine y={this.props.data.systemChangeRequestById.testingEstimate} stroke=\"blue\" ifOverflow=\"extendDomain\" />\r\n                    <Scatter\r\n                        name=\"Списано тестирование\"\r\n                        data= {\r\n                            this.props.data.systemChangeRequestById.testingTimeSheetsByDate.map(item => {\r\n                                return { date: new Date(item.date).getTime(), timeSpentCumsum: item.timeSpentCumsum }\r\n                            })\r\n                        }\r\n                        line fill=\"blue\"\r\n                    />\r\n                </ScatterChart>\r\n            </Box>\r\n        );\r\n    }\r\n}\r\n\r\nexport default graphql(fetchSystemChangeRequest, {\r\n    options: (props) => { return { variables: { id: props.match.params.id }}}\r\n})(SystemChangeRequestDetail);"]},"metadata":{},"sourceType":"module"}